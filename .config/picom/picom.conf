####################################
# Picom: Best Performance & Stability (Hybrid GPU)
####################################

backend = "egl";                  # GPU-accelerated, good on AMD + hybrid
vsync = true;                     # prevents tearing on AMD (recommended)
shadow = false;

####################################
# Smooth fades
####################################
fading = true;
fade-delta = 6;
fade-in-step = 0.05;
fade-out-step = 0.05;
no-fading-openclose = true;
no-fading-destroyed-argb = true;

####################################
# Transparency
####################################
inactive-opacity = 1.0; active-opacity = 1.0; frame-opacity = 1.0;
opacity-rule = [ "90:class_g = 'Alacritty'", "80:class_g = 'dev.warp.Warp'", "90:class_g = 'i3bar'", "90:class_g = 'i3status'"];
# opacity-rule = [
#   "90:class_g = 'Alacritty'",
#   "80:class_g = 'dev.warp.Warp'",
#   "90:class_g = 'i3bar'",
#   "90:class_g = 'i3status'",
#   "90:class_g = 'Google-chrome'"
# ];

####################################
# Background blur 
####################################
# Modern blur block syntax – this is what actually controls the blur.
# Gaussian blur works with experimental backends (egl/glx).
# blur = {
#   method = "dual_kawase";    # gaussian | box | kernel | dual_kawase (if supported)
#   size = 12;              # kernel size (higher = stronger + slower)
#   deviation = 1.0;        # standard deviation for gaussian blur
#   strength = 5;           # mainly used for dual_kawase, harmless to keep
# };
#
# # Enable blur on semi-transparent / ARGB windows.
# blur-background = true;
# blur-background-frame = false;
# blur-background-fixed = false;
#
# # Don’t blur panels, desktop, etc. (optional but recommended)
# blur-background-exclude = [
#   "window_type = 'dock'",
#   "window_type = 'desktop'",
#   "_GTK_FRAME_EXTENTS@:c"
# ];

####################################
# Performance tuning
####################################
use-damage = true;                # essential for EGL performance
unredir-if-possible = false;      # keep stability on hybrid GPUs
detect-rounded-corners = false;
detect-client-opacity = true;
detect-transient = true;

####################################
# EGL / GLX tuning
####################################
glx-no-stencil = true;            # safe + improves FPS
glx-copy-from-front = false;

experimental-backends = true;

####################################
# Notes
# - Make sure you are NOT starting picom with flags that override this,
#   e.g. `picom --backend xrender` will kill blur.
# - Terminals need some transparency for blur to be visible; your
#   opacity rules for Alacritty / Warp already handle that.
# - If blur still won’t show, try changing this line temporarily:
#       backend = "glx";
#   Some setups still only expose advanced blur reliably on GLX.
####################################
