####################################
# Picom: Best Performance & Stability (Hybrid GPU)
####################################

backend = "egl";                  # GPU-accelerated, stable for AMD+iGPU
vsync = true;                     # prevents tearing on AMD (recommended)
shadow = false;

####################################
# Smooth fades
####################################
fading = true;
fade-delta = 6;
fade-in-step = 0.05;
fade-out-step = 0.05;
no-fading-openclose = true;
no-fading-destroyed-argb = true;

####################################
# Transparency
####################################
inactive-opacity = 1.0;
active-opacity = 1.0;
frame-opacity = 1.0;

opacity-rule = [
  "90:class_g = 'Alacritty'",
  "80:class_g = 'dev.warp.Warp'",
];

####################################
# Performance tuning
####################################
use-damage = true;                # essential for EGL performance
unredir-if-possible = false;      # IMPORTANT: keeps stability on hybrid GPUs
detect-rounded-corners = false;
detect-client-opacity = true;
detect-transient = true;

####################################
# EGL-specific tuning
####################################
glx-no-stencil = true;            # safe + improves FPS
glx-copy-from-front = false;

experimental-backends = true;

####################################
# Notes
# - vsync=true avoids screen tearing on AMD panels.
# - unredir-if-possible=false is required to avoid freeze/black screen
#   when fullscreen apps switch GPUs or when using hybrid graphics.
# - EGL backend is the most stable for AMD+iGPU systems.
####################################
